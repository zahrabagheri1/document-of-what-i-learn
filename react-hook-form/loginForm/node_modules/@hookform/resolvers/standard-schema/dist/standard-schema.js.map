{"version":3,"file":"standard-schema.js","sources":["../src/standard-schema.ts"],"sourcesContent":["import { toNestErrors, validateFieldsNatively } from '@hookform/resolvers';\nimport { StandardSchemaV1 } from '@standard-schema/spec';\nimport { FieldError } from 'react-hook-form';\nimport type { Resolver } from './types';\n\nconst parseIssues = (issues: readonly StandardSchemaV1.Issue[]) => {\n  const errors: Record<string, FieldError> = {};\n\n  for (let i = 0; i < issues.length; i++) {\n    const issue = issues[i];\n    const path = issue.path?.join('.') ?? '';\n\n    if (path) {\n      if (!errors[path]) {\n        errors[path] = { message: issue.message } as FieldError;\n      }\n    }\n  }\n\n  return errors;\n};\n\nexport const standardSchemaResolver: Resolver =\n  (schema) => async (values, _, options) => {\n    let result = schema['~standard'].validate(values);\n    if (result instanceof Promise) {\n      result = await result;\n    }\n\n    if (result.issues) {\n      const errors = parseIssues(result.issues);\n\n      return {\n        values: {},\n        errors: toNestErrors(errors, options),\n      };\n    }\n\n    options.shouldUseNativeValidation && validateFieldsNatively({}, options);\n\n    return {\n      values: values,\n      errors: {},\n    };\n  };\n"],"names":["schema","values","_","options","_temp2","result","issues","errors","i","length","_issue$path$join","_issue$path","issue","path","join","message","parseIssues","toNestErrors","shouldUseNativeValidation","validateFieldsNatively","validate","_temp","Promise","resolve","then","_result","e","reject"],"mappings":"oEAuBE,SAACA,GAAM,OAAA,SAAYC,EAAQC,EAAGC,GAAO,IAAIC,IAAAA,EAAAA,WAMvC,GAAIC,EAAOC,OAAQ,CACjB,IAAMC,EAzBQ,SAACD,GAGnB,IAFA,IAAMC,EAAqC,CAAA,EAElCC,EAAI,EAAGA,EAAIF,EAAOG,OAAQD,IAAK,CAAAE,IAAAA,EAAAC,EAChCC,EAAQN,EAAOE,GACfK,EAA4BH,OAAxBA,EAAa,OAAbC,EAAGC,EAAMC,WAAI,EAAVF,EAAYG,KAAK,MAAIJ,EAAI,GAElCG,IACGN,EAAOM,KACVN,EAAOM,GAAQ,CAAEE,QAASH,EAAMG,UAGtC,CAEA,OAAOR,CACT,CAUqBS,CAAYX,EAAOC,QAElC,MAAO,CACLL,OAAQ,CAAE,EACVM,OAAQU,EAAYA,aAACV,EAAQJ,GAEjC,CAIA,OAFAA,EAAQe,2BAA6BC,EAAAA,uBAAuB,CAAA,EAAIhB,GAEzD,CACLF,OAAQA,EACRM,OAAQ,GACR,EAnBEF,EAASL,EAAO,aAAaoB,SAASnB,GAAQoB,EAAA,WAAA,GAC9ChB,aAAkBiB,QAAOA,OAAAA,QAAAC,QACZlB,GAAMmB,KAAAC,SAAAA,GAArBpB,EAAMoB,CAAgB,EAAAH,CAF0B,GAE1BA,OAAAA,QAAAC,QAAAF,GAAAA,EAAAG,KAAAH,EAAAG,KAAApB,GAAAA,IAkB1B,CAAC,MAAAsB,GAAAJ,OAAAA,QAAAK,OAAAD,EAAA,CAAA,CAAA"}